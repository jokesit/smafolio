{% extends 'base.html' %}

{% block content %}
<div class="max-w-4xl mx-auto bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden my-8">
    
    <div class="p-4 border-b border-slate-100 bg-slate-50">
        <a href="{% url 'public_portfolio' item.owner.username %}" class="inline-flex items-center text-sm text-slate-600 hover:text-indigo-600 font-medium transition group">
            <svg class="w-5 h-5 mr-1 text-slate-400 group-hover:text-indigo-600 transition" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
            </svg>
            กลับไปหน้าผลงานรวม
        </a>
    </div>

    <div class="w-full h-64 md:h-100 bg-slate-100 relative">
        <img src="{{ item.cover_image.url }}" alt="{{ item.title }}" class="w-full h-full object-contain bg-slate-200">
    </div>

    <div class="p-8 md:p-12">
        <div class="flex flex-wrap items-center gap-4 mb-6">
            <span class="px-3 py-1.5 rounded-full bg-indigo-50 text-indigo-700 text-sm font-bold tracking-wide">
                {{ item.category.name|default:"ทั่วไป" }}
            </span>
            <span class="flex items-center text-slate-500 text-sm font-medium">
                <svg class="w-4 h-4 mr-1.5 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                </svg>
                {{ item.event_date|date:"d F Y" }}
            </span>
        </div>

        <h1 class="text-3xl md:text-4xl font-bold text-slate-900 mb-8 leading-tight">
            {{ item.title }}
        </h1>
        
        <div class="prose prose-lg prose-indigo max-w-none text-slate-600 leading-relaxed font-light mb-12">
            {{ item.description|linebreaksbr|cut:"<br /><br />"|safe }}
        </div>

        {% if item.video_link %}
        <div class="mt-12 pt-10 border-t border-slate-100">
            <h3 class="text-xl font-bold text-slate-800 mb-6 flex items-center">
                <svg class="w-6 h-6 mr-2 text-red-600" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/>
                </svg>
                วิดีโอกิจกรรม
            </h3>
            
            <div class="relative w-full overflow-hidden rounded-2xl shadow-lg border border-slate-200 bg-black" style="padding-bottom: 56.25%;">
                <iframe
                    class="absolute top-0 left-0 w-full h-full"
                    src="{{ item.get_embed_url }}"
                    frameborder="0"
                    loading="lazy"
                    referrerpolicy="strict-origin-when-cross-origin"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen>
                </iframe>
            </div>
            <p>{{item.get_embed_url}}</p>
        </div>
        {% endif %}

        {% if item.images.all %}
        <div class="mt-12 pt-10 border-t border-slate-100">
            <h3 class="text-xl font-bold text-slate-800 mb-6 flex items-center">
                <svg class="w-5 h-5 mr-2 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                </svg>
                ภาพกิจกรรมเพิ่มเติม
            </h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                {% for img in item.images.all %}
                    <div class="rounded-xl overflow-hidden shadow-sm border border-slate-200 bg-slate-50" style="aspect-ratio: 4/3;">
                        <img src="{{ img.image.url }}" 
                             alt="Gallery image"
                             class="w-full h-full object-cover hover:scale-105 transition duration-500">
                    </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}